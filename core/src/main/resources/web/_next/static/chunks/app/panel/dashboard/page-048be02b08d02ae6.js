(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7156],{14133:(e,t,n)=>{Promise.resolve().then(n.bind(n,78999))},14657:(e,t,n)=>{"use strict";n.d(t,{e:()=>m});var r=n(95155),a=n(12115),s=n(28916),l=n(42638),i=n.n(l),o=n(53999),c=n(71365),d=n(52815);let u=(0,d.mt)("terminal.max-log-lines");function x(e){let t,{time:n,level:a,thread:l,source:c,line:u,thrownMessage:x,simple:m,visible:h}=e,f=c.split("."),p=f[f.length-1];switch(a){case"INFO":t="text-green-700 dark:text-green-500";break;case"WARN":t="text-yellow-700 dark:text-yellow-600";break;case"ERROR":t="text-red-700 dark:text-red-400"}return(0,r.jsxs)("p",{className:(0,o.cn)("leading-[133%] font-[Consolas] space-x-1",(0,d.mt)("terminal.word-wrap")?"text-wrap wrap-break-word whitespace-pre-wrap":"whitespace-pre",h?"":"hidden"),style:{fontSize:(0,d.mt)("terminal.font-size")+"px"},children:[(0,d.mt)("terminal.log-time")&&(0,r.jsx)("span",{className:"text-blue-500 dark:text-blue-400",children:"[".concat((0,s.GP)(new Date(n),"HH:mm:ss"),"]")}),!m&&(0,d.mt)("terminal.thread-name")&&(0,r.jsx)("span",{className:t,children:"[".concat(l,"/").concat(a,"]")}),!m&&(0,d.mt)("terminal.source-name")&&p&&(0,r.jsx)("span",{className:"text-emerald-600 dark:text-emerald-500 max-md:hidden",children:"(".concat(p,")")}),null==x?(0,d.mt)("terminal.convert-ansi-code")?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:new(i())().toHtml(u)}}):(0,r.jsx)("span",{children:u}):(0,d.mt)("terminal.convert-ansi-code")?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:new(i())().toHtml(u+"\n"+x)}}):(0,r.jsx)("span",{children:u+"\n"+x})]})}function m(e){let{client:t,simple:n,level:s,className:l}=e,i=(0,a.useRef)(null),[d,m]=(0,a.useState)([]),h=e=>{m(t=>(t.length+1>u&&t.shift(),[...t,e]))};return(0,a.useEffect)(()=>{if(!i.current)return;let e=i.current;e.scrollTo({top:e.scrollHeight})},[d]),(0,a.useEffect)(()=>{if(t)return t.onMessage((e,t)=>{switch(e){case"init":for(let e=t.length-u>0?t.length-u:0;e<t.length;e++)h(t[e]);break;case"log":h(t)}}),()=>void(i.current&&(i.current.innerHTML=""))},[t]),(0,r.jsx)("div",{className:(0,o.cn)(l,"border rounded-sm bg-background overflow-auto p-2"),ref:i,children:d.map((e,t)=>(0,a.createElement)(x,{...e,simple:n,visible:(0,c.k)(e.level)>=(0,c.k)(null!=s?s:c.I),key:t}))})}},16103:(e,t,n)=>{"use strict";n.d(t,{B6:()=>i,CB:()=>h,EW:()=>m,HQ:()=>o,Hy:()=>l,Q4:()=>u,_L:()=>c,lE:()=>x,zf:()=>d});var r=n(56671),a=n(31886),s=n(53999);async function l(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{await (0,a.ow)("/api/players/op?uuid=".concat(e)),t&&r.oR.success("成功给予该玩家OP权限")}catch(e){(0,a.Kf)(e,"无法给予该玩家OP权限",[[400,"请求参数错误"],[401,"未登录"]])}}async function i(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{await (0,a.ow)("/api/players/deop?uuid=".concat(e)),t&&r.oR.success("成功解除该玩家OP权限")}catch(e){(0,a.Kf)(e,"无法解除该玩家OP权限",[[400,"请求参数错误"],[401,"未登录"]])}}async function o(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{await (0,a.ow)("/api/players/kick?uuid=".concat(e,"&r=").concat(t)),n&&r.oR.success("已踢出该玩家")}catch(e){(0,a.Kf)(e,"无法踢出该玩家",[[400,"请求参数错误"],[401,"未登录"],[403,"该玩家不在线"]])}}async function c(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{await (0,a.ow)("/api/players/ban?uuid=".concat(e,"&r=").concat(t)),n&&r.oR.success("已封禁该玩家")}catch(e){(0,a.Kf)(e,"无法封禁该玩家",[[400,"请求参数错误"],[401,"未登录"]])}}async function d(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{await (0,a.ow)("/api/players/pardon?uuid=".concat(e)),t&&r.oR.success("已解封该玩家")}catch(e){(0,a.Kf)(e,"无法解封该玩家",[[400,"请求参数错误"],[401,"未登录"]])}}async function u(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{await (0,a.ow)("/api/players/gamemode?uuid=".concat(e,"&gm=").concat(t)),n&&r.oR.success("已将该玩家的游戏模式设置为"+(0,s.Cq)(t))}catch(e){(0,a.Kf)(e,"无法设置该玩家的游戏模式",[[400,"请求参数错误"],[401,"未登录"]])}}async function x(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{await (0,a.ow)("/api/whitelist/".concat(e?"enable":"disable")),t&&r.oR.success("已".concat(e?"启用":"禁用","白名单"))}catch(t){(0,a.Kf)(t,"无法".concat(e?"启用":"禁用","白名单"),[[401,"未登录"],[500,"服务器内部错误"]])}}async function m(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{await (0,a.ow)("/api/whitelist/add?name=".concat(e,"&uuid=").concat(t)),n&&r.oR.success("已将该玩家加入白名单")}catch(e){(0,a.Kf)(e,"无法将该玩家加入白名单",[[400,"请求参数错误"],[401,"未登录"],[500,"服务器内部错误"]])}}async function h(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{await (0,a.ow)("/api/whitelist/remove?name=".concat(e,"&uuid=").concat(t)),n&&r.oR.success("已将该玩家移出白名单")}catch(e){(0,a.Kf)(e,"无法将该玩家移出白名单",[[400,"请求参数错误"],[401,"未登录"],[500,"服务器内部错误"]])}}},16268:(e,t,n)=>{"use strict";n.d(t,{OJ:()=>s,qw:()=>l,r4:()=>i});let r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],a=["k","l","m","n","o"];function s(e){return e.replaceAll("\xc2","")}function l(e){return e.replaceAll("\xa7","\xc2\xa7")}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,l=s(e),i=document.createElement("span");i.className="cc-root";let o=i,c=1,d=0;for(let e=0;e<l.length;e++){let s=l[e];if("\n"===s&&c<t){o.appendChild(document.createElement("br")),c++,d=0;continue}if("\xa7"===s){let t=l[e+1];if("r"===t){o=i,e++;continue}let n=r.includes(t),s=a.includes(t);if(!n&&!s)continue;n&&(o=i);let c=document.createElement("span");c.className="cc-".concat(t),o.appendChild(c),o=c,e++}else d<n&&(o.innerHTML+=s,d++)}return i}},16559:(e,t,n)=>{"use strict";n.d(t,{$v:()=>f,EO:()=>u,Lt:()=>i,Rx:()=>p,Zr:()=>v,ck:()=>m,r7:()=>h,tv:()=>o,wd:()=>x});var r=n(95155);n(12115);var a=n(17649),s=n(53999),l=n(97168);function i(e){let{...t}=e;return(0,r.jsx)(a.bL,{"data-slot":"alert-dialog",...t})}function o(e){let{...t}=e;return(0,r.jsx)(a.l9,{"data-slot":"alert-dialog-trigger",...t})}function c(e){let{...t}=e;return(0,r.jsx)(a.ZL,{"data-slot":"alert-dialog-portal",...t})}function d(e){let{className:t,...n}=e;return(0,r.jsx)(a.hJ,{"data-slot":"alert-dialog-overlay",className:(0,s.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function u(e){let{className:t,...n}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{}),(0,r.jsx)(a.UC,{"data-slot":"alert-dialog-content",className:(0,s.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n})]})}function x(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,s.cn)("flex flex-col gap-2 text-center sm:text-left",t),...n})}function m(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,s.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...n})}function h(e){let{className:t,...n}=e;return(0,r.jsx)(a.hE,{"data-slot":"alert-dialog-title",className:(0,s.cn)("text-lg font-semibold",t),...n})}function f(e){let{className:t,...n}=e;return(0,r.jsx)(a.VY,{"data-slot":"alert-dialog-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...n})}function p(e){let{className:t,...n}=e;return(0,r.jsx)(a.rc,{className:(0,s.cn)((0,l.r)(),t),...n})}function v(e){let{className:t,...n}=e;return(0,r.jsx)(a.ZD,{className:(0,s.cn)((0,l.r)({variant:"outline"}),t),...n})}},19832:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var r=n(19087);let a=new(n.n(r)())},55424:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(12115),a=n(16453),s=n(56671),l=n(31886);class i{init(){var e,t,n;null==(e=this.socket)||e.addEventListener("open",()=>{console.log("Terminal connected."),this.send({type:"auth",data:(0,a.getCookie)("token")})}),null==(t=this.socket)||t.addEventListener("error",e=>{console.log("Terminal connection failed. ",e),s.oR.error("无法连接到终端WebSocket")}),null==(n=this.socket)||n.addEventListener("close",()=>{console.log("Terminal disconnected.")})}onOpen(e){var t;if(!this.socket)throw Error("WebSocket not initialized.");null==(t=this.socket)||t.addEventListener("open",()=>e())}onMessage(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.addEventListener("message",t=>{let{type:n,data:r}=JSON.parse(t.data);if(console.log("[Terminal] "+r.line),"init"===n&&!(r instanceof Array))throw Error("Received an incorrect initial packet.");if("error"===n)throw s.oR.error("Packet Error",{description:r}),Error("Packet error: "+r);e(n,r)})}send(e){if(!this.socket)throw Error("WebSocket not initialized.");this.socket.send(JSON.stringify(e))}close(){this.socket&&(this.socket.close(),this.socket=null)}constructor(){this.socket=null,(0,a.hasCookie)("token")||(window.location.href="/login"),this.socket=new WebSocket(l.yq+"/terminal"),this.init()}}function o(){let[e,t]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=new i;return t(e),()=>e.close()},[]),e}},71365:(e,t,n)=>{"use strict";n.d(t,{I:()=>r,k:()=>a});let r=(0,n(52815).mt)("terminal.log-level");function a(e){switch(e){case"INFO":return 1;case"WARN":return 2;case"ERROR":return 3}}},78999:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>e_});var r=n(95155),a=n(12115),s=n(98611);let l=function(){let e=a.createContext(void 0);return e.displayName="APIContext",e}(),i=a.createContext(void 0);i.displayName="APIContext";var o=n(31886),c=n(53999),d=n(17881),u=n(44940),x=n(381),m=n(32568),h=n(27265),f=n(56671),p=n(88482),v=n(95011),j=n(88145),g=n(97168),b=n(99211),w=n(51154);function y(e){let{className:t,...n}=e;return(0,r.jsx)(w.A,{role:"status","aria-label":"Loading",className:(0,c.cn)("size-4 animate-spin",t),...n})}var N=n(86801),k=n(55028),C=n(51362),E=n(41085),A=n(52815),_=n(16268);let L=(0,k.default)(()=>Promise.all([n.e(4654),n.e(1376),n.e(6859),n.e(8638),n.e(4695),n.e(2674),n.e(1752)]).then(n.bind(n,11752)),{loadableGenerated:{webpack:()=>[11752]},ssr:!1});function S(e){let{children:t,asChild:n}=e,[s,l]=(0,a.useState)(""),{theme:i}=(0,C.D)(),d=async()=>{try{let e=await (0,o.qV)("/api/control/properties");l((0,c.QM)(e.properties))}catch(e){(0,o.Kf)(e,"无法获取server.properties",[[401,"未登录"],[500,"服务器内部错误"]])}},u=async()=>{try{await (0,o.ow)("/api/control/properties",(0,_.qw)((0,c.q3)(s))),f.oR.success("保存成功",{description:"重启服务器以使改动生效"})}catch(e){(0,o.Kf)(e,"无法保存server.properties",[[401,"未登录"],[500,"服务器内部错误"]])}};return(0,r.jsxs)(E.cj,{onOpenChange:e=>e&&d(),children:[(0,r.jsx)(E.CG,{asChild:n,children:t}),(0,r.jsxs)(E.h,{children:[(0,r.jsxs)(E.Fm,{children:[(0,r.jsx)(E.qp,{children:"编辑 server.properties"}),(0,r.jsxs)(E.Qs,{children:["在此编辑服务器配置文件，你也可以直接编辑服务器目录下的",(0,r.jsx)("code",{children:"server.properties"}),"文件。"]})]}),(0,r.jsx)("div",{className:"flex flex-col h-full",children:s&&(0,r.jsx)(L,{defaultLanguage:"properties",value:s,theme:"dark"===i?"vs-dark":"vs",options:{minimap:{enabled:!1},automaticLayout:!0,...A.FN},onChange:e=>l(null!=e?e:"")})}),(0,r.jsxs)(E.XW,{children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"需重启服务器以使改动生效。"}),(0,r.jsx)(E.kN,{asChild:!0,children:(0,r.jsx)(g.$,{className:"cursor-pointer",onClick:()=>u(),children:"保存设置"})})]})]})]})}var R=n(62177),M=n(71153),T=n(48778),P=n(99840),z=n(30070),O=n(99474),I=n(19832);let K=M.z.object({motd:M.z.string().nonempty("Motd不可为空").refine(e=>e.split("\n").length<=2,"Motd行数最大为2")});function H(e){let{motd:t,asChild:n,children:s}=e,[l,i]=(0,a.useState)(!1),d=(0,R.mN)({resolver:(0,T.u)(K),values:{motd:(0,_.OJ)(t)}}),u=async e=>{try{await (0,o.ow)("/api/info/motd",(0,_.qw)((0,c.q3)(e.motd))),I.P.emit("refresh-data"),i(!1)}catch(e){(0,o.Kf)(e,"修改Motd失败",[[400,"请求参数错误"],[401,"未登录"],[500,"服务器内部错误"]])}};return(0,r.jsxs)(P.lG,{open:l,onOpenChange:i,children:[(0,r.jsx)(P.zM,{asChild:n,children:s}),(0,r.jsx)(P.Cf,{children:(0,r.jsx)(z.lV,{...d,children:(0,r.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:d.handleSubmit(u),children:[(0,r.jsxs)(P.c7,{children:[(0,r.jsx)(P.L3,{children:"编辑 Motd"}),(0,r.jsxs)(P.rr,{children:["在此编辑和预览服务器 Motd。",(0,r.jsx)("span",{className:"text-red-700 dark:text-red-400",children:"注：此功能在Fabric不稳定，原因未知。"})]})]}),(0,r.jsx)(z.zB,{control:d.control,name:"motd",render:e=>{let{field:t}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.MJ,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 min-w-0",children:[(0,r.jsx)(v.Z,{maxLines:2,className:"wrap-anywhere",children:"\xa77"+t.value}),(0,r.jsx)(O.T,{...t,rows:2,placeholder:"请输入文本..."})]})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsxs)(P.Es,{className:"flex flex-row !justify-between",children:[(0,r.jsx)(g.$,{type:"button",variant:"outline",size:"icon",className:"cursor-pointer",onClick:()=>d.setValue("motd",d.getValues().motd+"\xa7"),children:"\xa7"}),(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsx)(P.HM,{asChild:!0,children:(0,r.jsx)(g.$,{variant:"outline",onClick:()=>d.reset(),children:"取消"})}),(0,r.jsx)(g.$,{type:"submit",children:"保存"})]})]})]})})})]})}let q={src:"/_next/static/media/pack.3fda983d.png"};function F(e){var t;let{className:n}=e,s=(0,a.useContext)(l),[i,p]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:(0,c.cn)("flex gap-1 [&>*]:cursor-pointer",n),children:[(null==s?void 0:s.whitelist)&&(0,r.jsx)(N.T,{asChild:!0,children:(0,r.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑白名单",children:(0,r.jsx)(d.A,{})})}),(0,r.jsx)(H,{motd:(0,c.QM)(null!=(t=null==s?void 0:s.motd)?t:""),asChild:!0,children:(0,r.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑Motd",children:(0,r.jsx)(u.A,{})})}),(0,r.jsx)(S,{asChild:!0,children:(0,r.jsx)(g.$,{variant:"ghost",size:"icon",title:"编辑server.properties",children:(0,r.jsx)(x.A,{})})}),(0,r.jsx)(g.$,{variant:"ghost",size:"icon",title:"重载服务器",disabled:i,onClick:()=>{p(!0),f.oR.promise((0,o.ow)("/api/control/reload"),{loading:"正在重载服务器...",success:()=>(p(!1),{message:"重载完毕"}),error:"重载失败"})},children:(0,r.jsx)(m.A,{})}),(0,r.jsx)(b.F,{title:"确定要停止服务器吗？",description:"此操作将保存所有服务器信息并关闭服务器，OPanel也将无法访问，之后您可以从后台手动启动服务器。",onAction:()=>{(0,o.ow)("/api/control/stop"),j(!0),f.oR.loading("正在停止服务器...")},asChild:!0,children:(0,r.jsx)(g.$,{variant:"outline",size:"icon",title:"停止服务器",disabled:v,children:v?(0,r.jsx)(y,{}):(0,r.jsx)(h.A,{})})})]})}function $(e){let{className:t}=e,n=(0,a.useContext)(l);return(0,r.jsxs)(p.Zp,{className:(0,c.cn)(t,"flex flex-col rounded-md max-lg:gap-3"),children:[(0,r.jsxs)("div",{className:"min-lg:flex-1 flex max-md:flex-col gap-6 max-lg:border-b max-lg:pb-3",children:[(0,r.jsx)("img",{className:"aspect-square h-full max-md:w-32 max-md:h-32 rounded-xs image-pixelated",src:n&&n.favicon?o.y0+n.favicon:q.src,alt:"favicon"}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex max-lg:flex-col gap-4 max-lg:gap-1 [&>*]:space-x-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-nowrap",children:"版本:"}),(0,r.jsx)("span",{children:null==n?void 0:n.version})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-nowrap",children:"端口:"}),(0,r.jsx)("span",{className:"text-emerald-500 font-[Consolas]",children:n?n.port:""})]})]}),(0,r.jsx)("div",{className:"h-fit text-sm",children:n&&(0,r.jsx)(v.Z,{maxLines:2,maxCharPerLine:45,children:"\xa77"+(0,c.QM)(n.motd)})})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-between",children:[(0,r.jsxs)(j.E,{className:"self-end max-lg:hidden",variant:"outline",children:[(0,r.jsx)("div",{className:(0,c.cn)("w-2 h-2 rounded-full",n?"bg-green-600":"bg-red-700")}),n?"正在运行":"未运行"]}),(0,r.jsx)(F,{className:"self-end max-lg:hidden"})]})]}),(0,r.jsx)(F,{className:"hidden flex-row-reverse self-start max-lg:flex"})]})}var W=n(14186),Z=n(6874),G=n.n(Z),J=n(13052);function Q(e){let{title:t,moreLink:n,className:a,innerClassName:s,children:l,...i}=e;return(0,r.jsxs)(p.Zp,{className:(0,c.cn)(a,"!p-0 flex flex-col gap-3 rounded-md"),children:[(0,r.jsxs)("div",{className:"p-4 pb-0 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,r.jsx)(i.icon,{size:20}),(0,r.jsx)("h2",{className:"text-lg font-semibold",children:t})]}),n&&(0,r.jsx)(g.$,{variant:"ghost",size:"sm",className:"text-muted-foreground cursor-pointer",asChild:!0,children:(0,r.jsxs)(G(),{href:n,children:["更多",(0,r.jsx)(J.A,{})]})})]}),(0,r.jsx)("div",{className:(0,c.cn)(s,"overflow-auto"),children:l})]})}function V(e){return e<10?"0".concat(e):e.toString()}var B=n(37777);function D(e){var t,n;let{className:s}=e,i=(0,a.useContext)(l),[o,c]=(0,a.useState)(null!=(t=null==i?void 0:i.uptime)?t:0),[d,u]=(0,a.useState)(null!=(n=null==i?void 0:i.ingameTime.current)?n:0);return(0,a.useEffect)(()=>{i&&(c(i.uptime),u(i.ingameTime.current))},[i]),(0,a.useEffect)(()=>{let e=setInterval(()=>{c(e=>e+1e3)},1e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{if(!(null==i?void 0:i.ingameTime.doDaylightCycle)||i.ingameTime.paused)return;let e=setInterval(()=>{u(e=>e+16.6)},16.6*i.ingameTime.mspt);return()=>clearInterval(e)},[null==i?void 0:i.ingameTime.doDaylightCycle,null==i?void 0:i.ingameTime.paused,null==i?void 0:i.ingameTime.mspt]),(0,r.jsx)(Q,{icon:W.A,title:"时间",className:s,innerClassName:"h-full p-4 pt-0 flex max-sm:flex-col max-sm:gap-4 [&>*]:flex-1",children:i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 justify-center items-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:function(e){let t=Math.floor(e/36e5),n=Math.floor((e-=36e5*t)/6e4),r=Math.floor((e-=6e4*n)/1e3);return"".concat(V(t),":").concat(V(n),":").concat(V(r))}(o)}),(0,r.jsx)("span",{className:"text-xs max-xl:text-sm text-muted-foreground",children:"服务器已正常运行"})]}),(0,r.jsxs)(B.m_,{children:[(0,r.jsx)(B.k$,{children:(0,r.jsxs)("div",{className:"h-full flex flex-col gap-1 justify-center items-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:function(e){let t=Math.floor(e/1e3+6)%24,n=Math.floor(e%1e3/16.6);return"".concat(V(t),":").concat(V(n))}(d%24e3)}),(0,r.jsx)("span",{className:"text-xs max-xl:text-sm text-muted-foreground",children:"游戏内时间"})]})}),(0,r.jsx)(B.ZI,{children:"请以游戏内实际时间为准，此处仅供参考"})]})]})})}var X=n(17580),U=n(88524);function Y(e){var t;let{className:n}=e,s=(0,a.useContext)(l);return(0,r.jsx)(Q,{icon:X.A,title:"在线玩家 (".concat(s?s.onlinePlayers.length:0," / ").concat(null!=(t=null==s?void 0:s.maxPlayerCount)?t:0,")"),moreLink:"/panel/players",className:n,innerClassName:"p-4 pt-0",children:(0,r.jsxs)(U.XI,{children:[(0,r.jsx)(U.A0,{children:(0,r.jsxs)(U.Hj,{children:[(0,r.jsx)(U.nd,{children:"玩家"}),(0,r.jsx)(U.nd,{className:"text-center",children:"游戏模式"}),(0,r.jsx)(U.nd,{className:"text-right",children:"延迟"})]})}),(0,r.jsx)(U.BF,{children:s&&s.onlinePlayers.map((e,t)=>{let{name:n,uuid:a,gamemode:s,ping:l}=e;return(0,r.jsxs)(U.Hj,{children:[(0,r.jsx)(U.nA,{className:"font-semibold",children:(0,r.jsxs)(B.m_,{children:[(0,r.jsx)(B.k$,{children:n}),(0,r.jsx)(B.ZI,{children:a})]})}),(0,r.jsx)(U.nA,{className:"text-center",children:(0,c.Cq)(s)}),(0,r.jsx)(U.nA,{className:(0,c.cn)("font-[Consolas] text-right",l<100?"text-green-600":l<200?"text-yellow-600":"text-red-700"),children:l+"ms"})]},t)})})]})})}var ee=n(93490),et=n(94754),en=n(87156),er=n(52071),ea=n(46697),es=n(83540),el=n(38124),ei=n(12319);let eo={light:"",dark:".dark"},ec=a.createContext(null);function ed(e){let{id:t,className:n,children:s,config:l,...i}=e,o=a.useId(),d="chart-".concat(null!=t?t:o.replace(/:/g,""));return(0,r.jsx)(ec.Provider,{value:{config:l},children:(0,r.jsxs)("div",{"data-slot":"chart","data-chart":d,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",n),...i,children:[(0,r.jsx)(eu,{id:d,config:l}),(0,r.jsx)(es.u,{children:s})]})})}let eu=e=>{let{id:t,config:n}=e,a=Object.entries(n).filter(e=>{var t;let[,n]=e;return null!=(t=n.theme)?t:n.color});return a.length?(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eo).map(e=>{let[n,r]=e;return"\n".concat(r," [data-chart=").concat(t,"] {\n").concat(a.map(e=>{var t,r;let[a,s]=e,l=null!=(r=null==(t=s.theme)?void 0:t[n])?r:s.color;return l?"  --color-".concat(a,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},ex=el.m;function em(e){let{active:t,className:n,indicator:s="dot",hideLabel:l=!1,hideIndicator:i=!1,labelFormatter:o,labelClassName:d,formatter:u,color:x,nameKey:m,labelKey:h,payload:f,label:p}=e,{config:v}=function(){let e=a.useContext(ec);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),j=a.useMemo(()=>{var e,t,n,a;if(l||!(null==f?void 0:f.length))return null;let[s]=f,i="".concat(null!=(n=null!=(t=null!=h?h:null==s?void 0:s.dataKey)?t:null==s?void 0:s.name)?n:"value"),u=eh(v,s,i),x=h||"string"!=typeof p?null==u?void 0:u.label:null!=(a=null==(e=v[p])?void 0:e.label)?a:p;return o?(0,r.jsx)("div",{className:(0,c.cn)("font-medium",d),children:o(x,f)}):x?(0,r.jsx)("div",{className:(0,c.cn)("font-medium",d),children:x}):null},[v,l,p,d,o,h,f]);if(!t||!(null==f?void 0:f.length))return null;let g=1===f.length&&"dot"!==s;return(0,r.jsxs)("div",{className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[g?null:j,(0,r.jsx)("div",{className:"grid gap-1.5",children:f.map((e,t)=>{var n,a,l,o,d;let h="".concat(null!=(l=null!=(a=null!=m?m:e.name)?a:e.dataKey)?l:"value"),f=eh(v,e,h),p=null!=(o=null!=x?x:null==(n=e.payload)?void 0:n.fill)?o:e.color;return(0,r.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===s&&"items-center"),children:u&&(null==e?void 0:e.value)!==void 0&&e.name?u(e.value,e.name,e,t,e.payload):(0,r.jsxs)(r.Fragment,{children:[(null==f?void 0:f.icon)?(0,r.jsx)(f.icon,{}):!i&&(0,r.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===s,"w-1":"line"===s,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===s,"my-0.5":g&&"dashed"===s}),style:{"--color-bg":p,"--color-border":p}}),(0,r.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",g?"items-end":"items-center"),children:[(0,r.jsxs)("div",{className:"grid gap-1.5",children:[g?j:null,(0,r.jsx)("span",{className:"text-muted-foreground",children:null!=(d=null==f?void 0:f.label)?d:e.name})]}),null!=e.value&&(0,r.jsx)("span",{className:"font-mono font-medium text-foreground tabular-nums",children:"number"==typeof e.value?e.value.toLocaleString():String(e.value)})]})]})},t)})})]})}function eh(e,t,n){if("object"!=typeof t||null===t)return;let r="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,a=n;return n in t&&"string"==typeof t[n]?a=t[n]:r&&n in r&&"string"==typeof r[n]&&(a=r[n]),a in e?e[a]:e[n]}ei.s;let ef={memory:{label:"内存占用"},cpu:{label:"CPU占用"}};function ep(e){let{className:t}=e,n=(0,a.useContext)(i);return(0,r.jsx)(Q,{icon:ea.A,title:"资源监控",className:(0,c.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,r.jsx)(ed,{config:ef,className:"w-full max-h-96",children:(0,r.jsxs)(ee.Q,{accessibilityLayer:!0,data:n,margin:{left:0,right:0,bottom:80},children:[(0,r.jsx)(et.d,{vertical:!1,stroke:"var(--border)"}),(0,r.jsx)(en.Gk,{dataKey:"memory",type:"monotone",fill:"url(#fillMemory)",stroke:"var(--color-chart-2)",strokeWidth:"2",isAnimationActive:!1}),(0,r.jsx)(en.Gk,{dataKey:"cpu",type:"monotone",fill:"url(#fillCpu)",stroke:"var(--color-foreground)",strokeWidth:"2",isAnimationActive:!1}),(0,r.jsx)(er.h,{hide:!0,domain:[0,100]}),(0,r.jsx)(ex,{cursor:!1,content:(0,r.jsx)(em,{hideLabel:!0,indicator:"line"})}),(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"fillMemory",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"10%",stopColor:"var(--color-chart-2)"}),(0,r.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})}),(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"fillCpu",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"10%",stopColor:"var(--color-foreground)"}),(0,r.jsx)("stop",{offset:"90%",stopColor:"var(--color-card)"})]})})]})})})}var ev=n(35695),ej=n(62978),eg=n(89852),eb=n(55424),ew=n(14657);function ey(e){let{className:t}=e,{push:n}=(0,ev.useRouter)(),a=(0,eb.A)();return(0,r.jsxs)(Q,{icon:ej.A,title:"服务器后台",moreLink:"/panel/terminal",className:t,innerClassName:"p-2 pt-0 h-full max-xl:h-96 flex flex-col gap-2 overflow-hidden",children:[(0,r.jsx)(ew.e,{client:a,simple:!0,className:"flex-1"}),(0,r.jsx)(eg.p,{className:"w-full rounded-sm cursor-pointer",placeholder:"发送消息 / 指令...",title:"转至后台页面",onClick:()=>n("/panel/terminal")})]})}var eN=n(25487);let ek={tps:{label:"TPS"}};function eC(e){let{className:t}=e,n=(0,a.useContext)(i);return(0,r.jsx)(Q,{icon:eN.A,title:"TPS监控",className:(0,c.cn)(t,"justify-between"),innerClassName:"!overflow-hidden",children:(0,r.jsx)(ed,{config:ek,className:"w-full max-h-20",children:(0,r.jsxs)(ee.Q,{accessibilityLayer:!0,data:n,margin:{left:0,right:0,bottom:20},children:[(0,r.jsx)(et.d,{vertical:!1,stroke:"var(--border)"}),(0,r.jsx)(en.Gk,{dataKey:"tps",type:"monotone",fill:"transparent",stroke:"var(--color-chart-3)",strokeWidth:"2",isAnimationActive:!1}),(0,r.jsx)(er.h,{hide:!0,domain:[0,20]}),(0,r.jsx)(ex,{cursor:!1,content:(0,r.jsx)(em,{hideLabel:!0,indicator:"line"})})]})})})}var eE=n(24232);let eA=(0,A.mt)("dashboard.monitor-interval");function e_(){let[e,t]=(0,a.useState)(),[n,d]=(0,a.useState)(Array(50).fill({memory:0,cpu:0,tps:20})),u=async()=>{try{let e=await (0,o.qV)("/api/info");t(e)}catch(e){(0,o.Kf)(e,"无法连接到服务器",[[401,"未登录"],[500,"服务器内部错误"]])}},x=async()=>{let e=[...await (0,c.LJ)(d)],{mem:t,cpu:n,tps:r}=await (0,o.qV)("/api/monitor");e.shift(),e.push({memory:t,cpu:n,tps:r}),d(e)};return(0,a.useEffect)(()=>{u(),I.P.on("refresh-data",()=>u())},[]),(0,a.useEffect)(()=>{let e=setInterval(()=>{x()},eA);return()=>clearInterval(e)},[]),(0,r.jsx)(eE.SubPage,{title:"仪表盘",icon:(0,r.jsx)(s.A,{}),outerClassName:"min-xl:max-h-screen min-xl:overflow-y-auto max-xl-h:max-h-[850px] max-xl:!max-h-none",className:"flex-1 min-h-0 grid grid-rows-5 grid-cols-3 max-xl:flex flex-col gap-3 pb-20 [&>*]:p-4",children:(0,r.jsx)(l.Provider,{value:e,children:(0,r.jsxs)(i.Provider,{value:n,children:[(0,r.jsx)($,{className:"row-start-1 col-span-2"}),(0,r.jsx)(D,{className:"row-start-5"}),(0,r.jsx)(Y,{className:"row-span-3 row-start-2"}),(0,r.jsx)(ep,{className:"row-span-3 row-start-2"}),(0,r.jsx)(eC,{className:"row-start-5"}),(0,r.jsx)(ey,{className:"row-span-5"})]})})})}},86801:(e,t,n)=>{"use strict";n.d(t,{T:()=>h});var r=n(95155),a=n(55028),s=n(12115),l=n(51362),i=n(56671),o=n(41085),c=n(97168),d=n(31886),u=n(16103),x=n(52815);let m=(0,a.default)(()=>Promise.all([n.e(4654),n.e(1376),n.e(6859),n.e(8638),n.e(4695),n.e(2674),n.e(1752)]).then(n.bind(n,11752)),{loadableGenerated:{webpack:()=>[11752]},ssr:!1});function h(e){let{onDisableWhitelist:t,children:n,asChild:a}=e,[h,f]=(0,s.useState)(""),{theme:p}=(0,l.D)(),v=async()=>{try{let e=await (0,d.qV)("/api/whitelist");f(JSON.stringify(e.whitelist,void 0,2))}catch(e){(0,d.Kf)(e,"无法获取白名单",[[401,"未登录"],[500,"服务器内部错误"]])}},j=async()=>{try{await (0,d.ow)("/api/whitelist/write",JSON.parse(h)),i.oR.success("保存成功")}catch(e){(0,d.Kf)(e,"无法保存白名单",[[401,"未登录"],[500,"服务器内部错误"]])}};return(0,r.jsxs)(o.cj,{onOpenChange:e=>e&&v(),children:[(0,r.jsx)(o.CG,{asChild:a,children:n}),(0,r.jsxs)(o.h,{children:[(0,r.jsxs)(o.Fm,{children:[(0,r.jsx)(o.qp,{children:"编辑白名单"}),(0,r.jsxs)(o.Qs,{children:["在此编辑服务器玩家白名单，你也可以直接编辑服务器目录下的",(0,r.jsx)("code",{children:"whitelist.json"}),"文件。"]})]}),(0,r.jsx)("div",{className:"flex flex-col h-full",children:h&&(0,r.jsx)(m,{defaultLanguage:"json",value:h,theme:"dark"===p?"vs-dark":"vs",options:{minimap:{enabled:!1},automaticLayout:!0,tabSize:2,...x.FN},onChange:e=>f(null!=e?e:"")})}),(0,r.jsxs)(o.XW,{children:[(0,r.jsx)(c.$,{variant:"destructive",className:"cursor-pointer",onClick:async()=>{await (0,u.lE)(!1),t&&t()},children:"禁用白名单"}),(0,r.jsx)(o.kN,{asChild:!0,children:(0,r.jsx)(c.$,{className:"cursor-pointer",onClick:()=>j(),children:"保存设置"})})]})]})]})}},88145:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var r=n(95155);n(12115);var a=n(99708),s=n(74466),l=n(53999);let i=(0,s.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:n,asChild:s=!1,...o}=e,c=s?a.DX:"span";return(0,r.jsx)(c,{"data-slot":"badge",className:(0,l.cn)(i({variant:n}),t),...o})}},88482:(e,t,n)=>{"use strict";n.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>s,aR:()=>l,wL:()=>d});var r=n(95155);n(12115);var a=n(53999);function s(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...n})}function l(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...n})}function i(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...n})}function o(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...n})}function c(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...n})}function d(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",t),...n})}},88524:(e,t,n)=>{"use strict";n.d(t,{A0:()=>l,BF:()=>i,Hj:()=>o,XI:()=>s,nA:()=>d,nd:()=>c});var r=n(95155);n(12115);var a=n(53999);function s(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",t),...n})})}function l(e){let{className:t,...n}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",t),...n})}function i(e){let{className:t,...n}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",t),...n})}function o(e){let{className:t,...n}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...n})}function c(e){let{className:t,...n}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}function d(e){let{className:t,...n}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}},95011:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(95155),a=n(12115),s=n(16268),l=n(53999);let i="|i!:;.";function o(e){return" "===e?" ":i.includes(e)?(0,l.gI)(i.split("")):(0,l.gI)("+/\\=023456789ABCDEFGHJKLMNOPQRSTUVWXYZabcdeghjmnopqrsuvwxyz\xa2\xa3\xa5\xb1\xb5\xc0\xc1\xc2\xc3\xc4\xc5\xc7\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xeb".split(""))}var c=n(21509),d=n.n(c),u=n(4424),x=n.n(u),m=n(4852),h=n.n(m);function f(e){let{maxLines:t=1,maxCharPerLine:n=1/0,children:i,className:c}=e,u=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(u.current)for(let e of(u.current.innerHTML="",u.current.appendChild((0,s.r4)(i,t,n)),u.current.getElementsByClassName("cc-k")))e instanceof HTMLSpanElement&&function(e){let t=e.innerText,n=()=>{e.innerText=Array.from(t).map(o).join(""),requestAnimationFrame(n)};requestAnimationFrame(n)}(e)},[i,t,n]),(0,r.jsx)("div",{className:(0,l.cn)("[&_*]:leading-0.5",c,d().className,x().className,h().variable),ref:u})}},99211:(e,t,n)=>{"use strict";n.d(t,{F:()=>s});var r=n(95155),a=n(16559);function s(e){let{title:t,description:n,cancellable:s=!0,onAction:l,asChild:i,children:o}=e;return(0,r.jsxs)(a.Lt,{children:[(0,r.jsx)(a.tv,{asChild:i,children:o}),(0,r.jsxs)(a.EO,{children:[(0,r.jsxs)(a.wd,{children:[(0,r.jsx)(a.r7,{className:"wrap-anywhere",children:t}),n&&(0,r.jsx)(a.$v,{children:n})]}),(0,r.jsxs)(a.ck,{children:[s&&(0,r.jsx)(a.Zr,{children:"取消"}),(0,r.jsx)(a.Rx,{onClick:()=>{l&&l()},children:"确定"})]})]})]})}},99474:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(95155);n(12115);var a=n(53999);function s(e){let{className:t,...n}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...n})}}},e=>{e.O(0,[6399,9994,8511,5702,5452,9641,3207,6671,3464,371,6874,6438,6858,193,5987,8441,5964,7358],()=>e(e.s=14133)),_N_E=e.O()}]);