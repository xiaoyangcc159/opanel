(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8130],{22726:(e,s,t)=>{"use strict";t.d(s,{b:()=>j});var a=t(95155),r=t(12115),i=t(52278),n=t(42355),l=t(13052),o=t(12767),c=t(36268),d=t(11032),u=t(88524),h=t(53999),x=t(97168),p=t(74466);t(76037);let m=(0,p.F)("flex w-fit items-stretch [&>*]:focus-visible:z-10 [&>*]:focus-visible:relative [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md has-[>[data-slot=button-group]]:gap-2",{variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});function g(e){let{className:s,orientation:t,...r}=e;return(0,a.jsx)("div",{role:"group","data-slot":"button-group","data-orientation":t,className:(0,h.cn)(m({orientation:t}),s),...r})}function j(e){var s;let{columns:t,data:p,pagination:m=!1,fallbackMessage:j="暂无数据",className:f}=e,[v,b]=(0,r.useState)({pageIndex:0,pageSize:10}),y=(0,c.N4)({columns:t,data:p,getCoreRowModel:(0,d.HT)(),getPaginationRowModel:m?(0,d.kW)():void 0,onPaginationChange:b,state:{pagination:v}});return(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)("div",{className:(0,h.cn)(f,"border rounded-md"),children:(0,a.jsxs)(u.XI,{children:[(0,a.jsx)(u.A0,{children:y.getHeaderGroups().map(e=>(0,a.jsx)(u.Hj,{children:e.headers.map(e=>(0,a.jsx)(u.nd,{children:e.isPlaceholder?null:(0,c.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(u.BF,{children:(null==(s=y.getRowModel().rows)?void 0:s.length)?y.getRowModel().rows.map(e=>(0,a.jsx)(u.Hj,{children:e.getVisibleCells().map(e=>(0,a.jsx)(u.nA,{children:(0,c.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(u.Hj,{className:"hover:bg-transparent",children:(0,a.jsx)(u.nA,{colSpan:t.length,className:"h-24 text-center",children:j})})})]})}),m&&(0,a.jsxs)("div",{className:"flex gap-3 items-center max-md:flex-col",children:[(0,a.jsxs)("div",{className:"flex gap-3 items-center [&_button]:cursor-pointer",children:[(0,a.jsx)(x.$,{variant:"outline",size:"icon",title:"跳转至第一页",onClick:()=>y.firstPage(),disabled:!y.getCanPreviousPage(),children:(0,a.jsx)(i.A,{})}),(0,a.jsxs)(g,{children:[(0,a.jsxs)(x.$,{variant:"outline",onClick:()=>y.previousPage(),disabled:!y.getCanPreviousPage(),children:[(0,a.jsx)(n.A,{}),"上一页"]}),(0,a.jsxs)(x.$,{variant:"outline",onClick:()=>y.nextPage(),disabled:!y.getCanNextPage(),children:["下一页",(0,a.jsx)(l.A,{})]})]}),(0,a.jsx)(x.$,{variant:"outline",size:"icon",title:"跳转至最后一页",onClick:()=>y.lastPage(),disabled:!y.getCanNextPage(),children:(0,a.jsx)(o.A,{})})]}),(0,a.jsxs)("span",{className:"text-muted-foreground text-sm",children:["第 ",v.pageIndex+1," 页 / 共 ",y.getPageCount()," 页"]})]})]})}},28042:(e,s,t)=>{"use strict";t.d(s,{Ik:()=>h,MG:()=>o,Sq:()=>d,iV:()=>x});var a=t(95155);t(12115);var r=t(74466),i=t(53999),n=t(97168),l=t(89852);function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"input-group",role:"group",className:(0,i.cn)("group/input-group border-input dark:bg-input/30 relative flex w-full items-center rounded-md border shadow-xs transition-[color,box-shadow] outline-none","h-9 min-w-0 has-[>textarea]:h-auto","has-[>[data-align=inline-start]]:[&>input]:pl-2","has-[>[data-align=inline-end]]:[&>input]:pr-2","has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3","has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3","has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50 has-[[data-slot=input-group-control]:focus-visible]:ring-[3px]","has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40",s),...t})}t(99474);let c=(0,r.F)("text-muted-foreground flex h-auto cursor-text items-center justify-center gap-2 py-1.5 text-sm font-medium select-none [&>svg:not([class*='size-'])]:size-4 [&>kbd]:rounded-[calc(var(--radius)-5px)] group-data-[disabled=true]/input-group:opacity-50",{variants:{align:{"inline-start":"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]","inline-end":"order-last pr-3 has-[>button]:mr-[-0.45rem] has-[>kbd]:mr-[-0.35rem]","block-start":"order-first w-full justify-start px-3 pt-3 [.border-b]:pb-3 group-has-[>input]/input-group:pt-2.5","block-end":"order-last w-full justify-start px-3 pb-3 [.border-t]:pt-3 group-has-[>input]/input-group:pb-2.5"}},defaultVariants:{align:"inline-start"}});function d(e){let{className:s,align:t="inline-start",...r}=e;return(0,a.jsx)("div",{role:"group","data-slot":"input-group-addon","data-align":t,className:(0,i.cn)(c({align:t}),s),onClick:e=>{var s,t;e.target.closest("button")||null==(t=e.currentTarget.parentElement)||null==(s=t.querySelector("input"))||s.focus()},...r})}let u=(0,r.F)("text-sm shadow-none flex gap-2 items-center",{variants:{size:{xs:"h-6 gap-1 px-2 rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-3.5 has-[>svg]:px-2",sm:"h-8 px-2.5 gap-1.5 rounded-md has-[>svg]:px-2.5","icon-xs":"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0","icon-sm":"size-8 p-0 has-[>svg]:p-0"}},defaultVariants:{size:"xs"}});function h(e){let{className:s,type:t="button",variant:r="ghost",size:l="xs",...o}=e;return(0,a.jsx)(n.$,{type:t,"data-size":l,variant:r,className:(0,i.cn)(u({size:l}),s),...o})}function x(e){let{className:s,...t}=e;return(0,a.jsx)(l.p,{"data-slot":"input-group-control",className:(0,i.cn)("flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",s),...t})}},31795:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ea});var a=t(95155),r=t(12115),i=t(17580),n=t(47924),l=t(6877),o=t(17881),c=t(42996),d=t(30064),u=t(53999);function h(e){let{className:s,...t}=e;return(0,a.jsx)(d.bL,{"data-slot":"tabs",className:(0,u.cn)("flex flex-col gap-2",s),...t})}function x(e){let{className:s,...t}=e;return(0,a.jsx)(d.B8,{"data-slot":"tabs-list",className:(0,u.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(d.l9,{"data-slot":"tabs-trigger",className:(0,u.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function m(e){let{className:s,...t}=e;return(0,a.jsx)(d.UC,{"data-slot":"tabs-content",className:(0,u.cn)("flex-1 outline-none",s),...t})}var g=t(22726),j=t(31886),f=t(5196),v=t(75494),b=t(12318),y=t(97092),w=t(74126),N=t(28113),C=t(37777),k=t(97168),z=t(99840),P=t(82714),A=t(89852);function $(e){let{title:s,description:t,label:i,placeholder:n,onAction:l,asChild:o,children:c}=e,d=(0,r.useRef)(null);return(0,a.jsxs)(z.lG,{children:[(0,a.jsx)(z.zM,{asChild:o,children:c}),(0,a.jsxs)(z.Cf,{children:[(0,a.jsxs)(z.c7,{children:[(0,a.jsx)(z.L3,{children:s}),t&&(0,a.jsx)(z.rr,{children:t})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(P.J,{children:i}),(0,a.jsx)(A.p,{placeholder:n,ref:d})]}),(0,a.jsxs)(z.Es,{children:[(0,a.jsx)(z.HM,{asChild:!0,children:(0,a.jsx)(k.$,{variant:"outline",children:"取消"})}),(0,a.jsx)(z.HM,{asChild:!0,children:(0,a.jsx)(k.$,{onClick:()=>{d.current&&l&&l(d.current.value)},children:"确定"})})]})]})]})}var I=t(88145);function O(e){let{isOnline:s,className:t}=e;return(0,a.jsxs)(I.E,{variant:"outline",children:[(0,a.jsx)("div",{className:(0,u.cn)("w-2 h-2 rounded-full",s?"bg-green-600":"bg-muted-foreground",t)}),s?"在线":"离线"]})}var _=t(16103),K=t(62177),M=t(48778),E=t(71153),L=t(41085),S=t(30070),F=t(23291),H=t(91503);function R(e){let{uuid:s}=e,t=(0,r.useRef)(null);return(0,r.useEffect)(()=>{t.current&&new H.A({canvas:t.current,skin:j.Hh+s,cape:j.v_+s})},[s]),(0,a.jsx)("canvas",{ref:t})}var W=t(95784),V=t(90088),q=t(19832);let B=E.z.object({gamemode:E.z.enum(Object.values(F.U)),isOp:E.z.boolean()});function G(e){var s;let{player:t,children:r,asChild:i}=e,n=(0,K.mN)({resolver:(0,M.u)(B),values:{gamemode:null!=(s=t.gamemode)?s:"adventure",isOp:t.isOp}}),o=async e=>{e.gamemode!==t.gamemode&&await (0,_.Q4)(t.uuid,e.gamemode,!1),e.isOp!==t.isOp&&(t.isOp?await (0,_.B6)(t.uuid,!1):await (0,_.Hy)(t.uuid,!1)),q.P.emit("refresh-data")};return(0,a.jsxs)(L.cj,{children:[(0,a.jsx)(L.CG,{asChild:i,children:r}),(0,a.jsx)(L.h,{children:(0,a.jsx)(S.lV,{...n,children:(0,a.jsxs)("form",{className:"flex-1 flex flex-col",onSubmit:n.handleSubmit(o),children:[(0,a.jsxs)(L.Fm,{children:[(0,a.jsx)(L.qp,{children:"编辑玩家"}),(0,a.jsx)(L.Qs,{children:"在此设置和管理该玩家的状态和角色。"})]}),(0,a.jsxs)("div",{className:"flex-1 px-4 flex flex-col gap-5",children:[(0,a.jsx)(R,{uuid:t.uuid}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,a.jsx)(O,{isOnline:t.isOnline}),t.name?(0,a.jsx)("h2",{className:"inline-block text-lg font-semibold",children:t.name}):(0,a.jsx)("span",{className:"text-muted-foreground italic",children:"<无名玩家>"})]}),(0,a.jsx)(S.zB,{control:n.control,name:"gamemode",render:e=>{let{field:s}=e;return(0,a.jsxs)(S.eI,{children:[(0,a.jsx)(S.lR,{children:"游戏模式"}),(0,a.jsx)(S.MJ,{children:(0,a.jsxs)(W.l6,{...s,onValueChange:s.onChange,children:[(0,a.jsx)(W.bq,{className:"w-full",children:(0,a.jsx)(W.yv,{})}),(0,a.jsxs)(W.gC,{children:[(0,a.jsx)(W.eb,{value:"adventure",children:"冒险"}),(0,a.jsx)(W.eb,{value:"survival",children:"生存"}),(0,a.jsx)(W.eb,{value:"creative",children:"创造"}),(0,a.jsx)(W.eb,{value:"spectator",children:"旁观"})]})]})}),(0,a.jsx)(S.C5,{})]})}}),(0,a.jsx)(S.zB,{control:n.control,name:"isOp",render:e=>{let{field:s}=e;return(0,a.jsxs)(S.eI,{className:"flex justify-between",children:[(0,a.jsx)(S.lR,{children:"OP权限"}),(0,a.jsx)(S.MJ,{children:(0,a.jsx)(V.d,{...s,value:"",defaultChecked:t.isOp,onCheckedChange:s.onChange})}),(0,a.jsx)(S.C5,{})]})}}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(P.J,{children:"管理"}),(0,a.jsxs)("div",{className:"grid grid-rows-2 grid-cols-2 gap-2 [&>*]:cursor-pointer",children:[t.name&&void 0!==t.isWhitelisted&&(t.isWhitelisted?(0,a.jsxs)(k.$,{variant:"outline",onClick:async()=>{await (0,_.CB)(t.name,t.uuid),q.P.emit("refresh-data")},children:[(0,a.jsx)(v.A,{}),"移出白名单"]}):(0,a.jsxs)(k.$,{variant:"outline",onClick:async()=>{await (0,_.EW)(t.name,t.uuid),q.P.emit("refresh-data")},children:[(0,a.jsx)(b.A,{}),"加入白名单"]})),(0,a.jsx)($,{title:"踢出玩家",description:"将玩家踢出服务器，之后玩家可重新加入服务器",label:"原因",placeholder:"请输入踢出原因...",onAction:async e=>{await (0,_.HQ)(t.uuid,e),q.P.emit("refresh-data")},asChild:!0,children:(0,a.jsxs)(k.$,{variant:"outline",className:void 0===t.isWhitelisted?"col-start-1":"col-start-2",disabled:!t.isOnline,children:[(0,a.jsx)(y.A,{}),"踢出服务器"]})}),t.isBanned?(0,a.jsxs)(k.$,{variant:"outline",className:void 0===t.isWhitelisted?"col-start-2":"col-span-2",onClick:async()=>{await (0,_.zf)(t.uuid),q.P.emit("refresh-data")},children:[(0,a.jsx)(N.A,{}),"解除封禁"]}):(0,a.jsx)($,{title:"封禁玩家",description:"将玩家踢出服务器并加入封禁列表，之后玩家将不可重新加入服务器",label:"原因",placeholder:"请输入封禁原因...",onAction:async e=>{await (0,_._L)(t.uuid,e),q.P.emit("refresh-data")},asChild:!0,children:(0,a.jsxs)(k.$,{variant:"destructive",className:void 0===t.isWhitelisted?"col-start-2":"col-span-2",children:[(0,a.jsx)(l.A,{}),"封禁玩家"]})})]})]})]}),(0,a.jsxs)(L.XW,{children:[(0,a.jsx)(L.kN,{asChild:!0,children:(0,a.jsx)(k.$,{type:"submit",className:"cursor-pointer",children:"确定"})}),(0,a.jsx)(L.kN,{asChild:!0,children:(0,a.jsx)(k.$,{variant:"outline",className:"cursor-pointer",children:"取消"})})]})]})})})]})}var Q=t(99211);let T=[{accessorKey:"name",header:"玩家名",cell:e=>{let{row:s}=e,{name:t,uuid:r}=s.original;return(0,a.jsxs)(C.m_,{children:[(0,a.jsx)(C.k$,{children:(0,a.jsx)(G,{player:s.original,asChild:!0,children:t?(0,a.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("img",{src:j.nF+r,alt:t,width:17,height:17}),(0,a.jsx)("span",{className:"font-semibold",children:t})]}):(0,a.jsx)("span",{className:"text-muted-foreground italic cursor-pointer",children:"<无名玩家>"})})}),(0,a.jsx)(C.ZI,{children:r})]})}},{accessorKey:"isOnline",header:()=>(0,a.jsx)("div",{className:"text-center",children:"状态"}),cell:e=>{let{row:s}=e,{isOnline:t}=s.original;return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(O,{isOnline:t})})}},{accessorKey:"uuid",header:"",cell:""},{accessorKey:"gamemode",header:()=>(0,a.jsx)("div",{className:"text-center",children:"游戏模式"}),cell:e=>{let{row:s}=e,{gamemode:t}=s.original;return t?(0,a.jsx)("div",{className:"text-center",children:(0,u.Cq)(t)}):(0,a.jsx)(a.Fragment,{})}},{accessorKey:"isWhitelisted",header:()=>(0,a.jsx)("div",{className:"text-center",children:"白名单"}),cell:e=>{let{row:s,column:t}=e;return(0,r.useEffect)(()=>{t.toggleVisibility(void 0!==s.original.isWhitelisted)},[s,t]),(0,a.jsx)("div",{className:"flex justify-center",children:s.original.isWhitelisted?(0,a.jsx)(f.A,{size:18,color:"var(--color-muted-foreground)"}):(0,a.jsx)(a.Fragment,{})})}},{accessorKey:"isOp",header:()=>(0,a.jsx)("div",{className:"text-center",children:"OP"}),cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"flex justify-center",children:s.original.isOp?(0,a.jsx)(f.A,{size:18,color:"var(--color-muted-foreground)"}):(0,a.jsx)(a.Fragment,{})})}},{header:" ",cell:e=>{let{row:s}=e,{name:t,uuid:r,isOnline:i,isWhitelisted:n}=s.original;return(0,a.jsxs)("div",{className:"flex justify-end [&>*]:h-4 [&>*]:cursor-pointer [&>*]:hover:!bg-transparent",children:[void 0!==n&&(n?(0,a.jsx)(k.$,{variant:"ghost",size:"icon",title:"移出白名单",onClick:async()=>{await (0,_.CB)(t,r),q.P.emit("refresh-data")},children:(0,a.jsx)(v.A,{})}):(0,a.jsx)(k.$,{variant:"ghost",size:"icon",title:"加入白名单",onClick:async()=>{await (0,_.EW)(t,r),q.P.emit("refresh-data")},children:(0,a.jsx)(b.A,{})})),i&&(0,a.jsx)($,{title:"踢出玩家",description:"将玩家踢出服务器，之后玩家可重新加入服务器",label:"原因",placeholder:"请输入踢出原因...",onAction:async e=>{await (0,_.HQ)(r,e),q.P.emit("refresh-data")},asChild:!0,children:(0,a.jsx)(k.$,{variant:"ghost",size:"icon",title:"踢出服务器",children:(0,a.jsx)(y.A,{})})}),(0,a.jsx)($,{title:"封禁玩家",description:"将玩家踢出服务器并加入封禁列表，之后玩家将不可重新加入服务器",label:"原因",placeholder:"请输入封禁原因...",onAction:async e=>{await (0,_._L)(r,e),q.P.emit("refresh-data")},asChild:!0,children:(0,a.jsx)(k.$,{variant:"ghost",size:"icon",title:"封禁玩家",children:(0,a.jsx)(l.A,{className:"stroke-red-400"})})}),(0,a.jsx)(Q.F,{title:"确定要删除 ".concat(t," 的游戏数据吗？"),description:"此操作将".concat(i?"把玩家踢出服务器并":"","清空该玩家的所有游戏数据，且被删除的数据将不可恢复。"),onAction:async()=>{i&&(await (0,_.HQ)(r,"管理员已清空你的玩家数据",!1),await (0,u.yy)(100)),await (0,_.wx)(r),q.P.emit("refresh-data")},asChild:!0,children:(0,a.jsx)(k.$,{variant:"ghost",size:"icon",title:"删除玩家数据",children:(0,a.jsx)(w.A,{className:"stroke-red-400"})})})]})}}],D=[{accessorKey:"name",header:"玩家名",cell:e=>{let{row:s}=e,{name:t,uuid:r}=s.original;return(0,a.jsxs)(C.m_,{children:[(0,a.jsx)(C.k$,{children:(0,a.jsx)(G,{player:s.original,asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("img",{src:j.nF+r,alt:t,width:17,height:17}),(0,a.jsx)("span",{className:"font-semibold",children:t})]})})}),(0,a.jsx)(C.ZI,{children:r})]})}},{accessorKey:"banReason",header:"封禁原因",cell:e=>{let{row:s}=e,{banReason:t}=s.original;return t&&(0,a.jsx)("span",{children:(0,u.QM)(t)})}},{accessorKey:"uuid",header:"",cell:""},{accessorKey:"isOp",header:()=>(0,a.jsx)("div",{className:"text-center",children:"OP"}),cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"flex justify-center",children:s.original.isOp?(0,a.jsx)(f.A,{size:18,color:"var(--color-muted-foreground)"}):(0,a.jsx)(a.Fragment,{})})}},{header:" ",cell:e=>{let{row:s}=e;return(0,a.jsx)(k.$,{variant:"ghost",size:"icon",className:"float-right h-4 cursor-pointer hover:!bg-transparent",title:"解除封禁",onClick:async()=>{await (0,_.zf)(s.original.uuid),q.P.emit("refresh-data")},children:(0,a.jsx)(N.A,{className:"stroke-green-600"})})}}];var J=t(24232),U=t(86801),X=t(28042),Z=t(52815),Y=t(84616),ee=t(56671),es=t(88524);function et(e){let{children:s,asChild:t}=e,[i,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(""),h=async()=>{try{let e=await (0,j.qV)("/api/banned-ips");o(e.bannedIps)}catch(e){(0,j.Kf)(e,"无法获取封禁IP列表",[[400,"请求参数错误"],[401,"未登录"]])}},x=async e=>{if(""===e||!(0,u.NU)(e))return void ee.oR.error("无法添加该IP到封禁列表",{description:"无效的IP地址"});if(l.includes(e))return void ee.oR.warning("该IP已在封禁列表中");try{await (0,j.ow)("/api/banned-ips/add?ip=".concat(e)),d(""),q.P.emit("refresh-data"),ee.oR.success("添加成功")}catch(e){(0,j.Kf)(e,"无法添加该IP到封禁列表",[[400,"无效的IP地址"],[401,"未登录"]])}},p=async e=>{try{await (0,j.ow)("/api/banned-ips/remove?ip=".concat(e)),q.P.emit("refresh-data"),ee.oR.success("移除成功")}catch(e){(0,j.Kf)(e,"无法从封禁列表移除该IP",[[400,"无效的IP地址"],[401,"未登录"]])}};return(0,r.useEffect)(()=>{q.P.on("refresh-data",()=>{h()})},[]),(0,r.useEffect)(()=>{i?h():d("")},[i]),(0,a.jsxs)(z.lG,{open:i,onOpenChange:n,children:[(0,a.jsx)(z.zM,{asChild:t,children:s}),(0,a.jsxs)(z.Cf,{children:[(0,a.jsxs)(z.c7,{children:[(0,a.jsx)(z.L3,{children:"管理封禁IP"}),(0,a.jsx)(z.rr,{children:"在此添加 / 移除被封禁的IP地址。"})]}),(0,a.jsxs)("div",{className:"border rounded-md",children:[(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto",children:(0,a.jsx)(es.XI,{children:(0,a.jsx)(es.BF,{children:l.map((e,s)=>(0,a.jsxs)(es.Hj,{children:[(0,a.jsx)(es.nA,{children:e}),(0,a.jsx)(es.nA,{children:(0,a.jsx)(k.$,{variant:"ghost",size:"icon",className:"float-right h-4 cursor-pointer hover:!bg-transparent",title:"解除封禁",onClick:()=>p(e),children:(0,a.jsx)(N.A,{className:"stroke-green-600"})})})]},s))})})}),(0,a.jsxs)("div",{className:(0,u.cn)("flex gap-2 p-2",l.length>0&&"border-t"),children:[(0,a.jsx)(A.p,{value:c,placeholder:"请输入IP地址以添加...",className:"h-8",onInput:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&c.length>0&&x(c)}),(0,a.jsx)(k.$,{variant:"ghost",size:"icon-sm",className:"cursor-pointer",disabled:0===c.length,onClick:()=>x(c),children:(0,a.jsx)(Y.A,{})})]})]}),(0,a.jsx)(z.Es,{children:(0,a.jsx)(z.HM,{asChild:!0,children:(0,a.jsx)(k.$,{variant:"outline",children:"关闭"})})})]})]})}function ea(){let[e,s]=(0,r.useState)([]),[t,d]=(0,r.useState)([]),[u,f]=(0,r.useState)(0),[v,b]=(0,r.useState)(!1),[y,w]=(0,r.useState)((0,Z.mt)("state.players.tab")),[N,C]=(0,r.useState)(""),z=(0,r.useMemo)(()=>e.filter(e=>{let{isBanned:s}=e;return!s}),[e]),P=(0,r.useMemo)(()=>e.filter(e=>{let{isBanned:s}=e;return s}),[e]),A=async()=>{try{let e=await (0,j.qV)("/api/players"),t=e.players.filter(e=>{let{name:s}=e;return void 0!==s}).sort((e,s)=>e.name.localeCompare(s.name));s(t),d(e.players.filter(e=>{let{name:s}=e;return void 0===s})),f(e.maxPlayerCount),b(e.whitelist)}catch(e){(0,j.Kf)(e,"无法获取玩家列表",[[400,"请求参数错误"],[401,"未登录"],[500,"服务器内部错误"]])}};return(0,r.useEffect)(()=>{A(),q.P.on("refresh-data",()=>A())},[]),(0,r.useEffect)(()=>{document.body.addEventListener("keydown",e=>{e.ctrlKey&&"ArrowRight"===e.key?w("banned-list"):e.ctrlKey&&"ArrowLeft"===e.key&&w("player-list")})},[]),(0,a.jsxs)(J.SubPage,{title:"玩家",subTitle:"player-list"===y?"玩家列表":"封禁列表",icon:(0,a.jsx)(i.A,{}),className:"flex flex-col gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"点击玩家名以进行更多操作。"}),(0,a.jsxs)(h,{value:y,onValueChange:e=>{w(e),(0,Z.kz)("state.players.tab",e)},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center max-lg:flex-col-reverse max-lg:items-start max-lg:gap-2",children:[(0,a.jsxs)(x,{className:"[&>*]:cursor-pointer",children:[(0,a.jsx)(p,{value:"player-list",children:"玩家列表 (".concat(e.filter(e=>{let{isOnline:s}=e;return s}).length," / ").concat(u,")")}),(0,a.jsx)(p,{value:"banned-list",children:"封禁列表 (".concat(e.filter(e=>{let{isBanned:s}=e;return s}).length,")")})]}),(0,a.jsxs)("div",{className:"flex gap-2 max-sm:flex-col max-sm:items-start",children:[(0,a.jsxs)(X.MG,{children:[(0,a.jsx)(X.Sq,{children:(0,a.jsx)(n.A,{})}),(0,a.jsx)(X.iV,{value:N,placeholder:"搜索玩家...",onChange:e=>C(e.target.value)})]}),(0,a.jsx)(et,{asChild:!0,children:(0,a.jsxs)(k.$,{variant:"outline",className:"cursor-pointer",children:[(0,a.jsx)(l.A,{}),"管理封禁IP"]})}),v?(0,a.jsx)(U.T,{onDisableWhitelist:()=>b(!1),asChild:!0,children:(0,a.jsxs)(k.$,{variant:"outline",className:"cursor-pointer",children:[(0,a.jsx)(o.A,{}),"编辑白名单"]})}):(0,a.jsxs)(k.$,{variant:"outline",className:"cursor-pointer",onClick:async()=>{await (0,_.lE)(!0),await A(),b(!0)},children:[(0,a.jsx)(c.A,{}),"启用白名单"]})]})]}),(0,a.jsx)(m,{value:"player-list",children:(0,a.jsx)(g.b,{columns:T,data:[...z.filter(e=>{let{name:s,isOnline:t}=e;return s.toLowerCase().includes(N.toLowerCase())&&t}),...z.filter(e=>{let{name:s,isOnline:t,isOp:a}=e;return s.toLowerCase().includes(N.toLowerCase())&&!t&&a}),...z.filter(e=>{let{name:s,isOnline:t,isOp:a}=e;return s.toLowerCase().includes(N.toLowerCase())&&!t&&!a}),...t],pagination:!0,fallbackMessage:"暂无玩家"})}),(0,a.jsx)(m,{value:"banned-list",children:(0,a.jsx)(g.b,{columns:D,data:P.filter(e=>{let{name:s}=e;return s.toLowerCase().includes(N.toLowerCase())}),pagination:!0,fallbackMessage:"暂无玩家"})})]})]})}},53571:(e,s,t)=>{Promise.resolve().then(t.bind(t,31795))},95784:(e,s,t)=>{"use strict";t.d(s,{bq:()=>u,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>d});var a=t(95155);t(12115);var r=t(14582),i=t(66474),n=t(5196),l=t(47863),o=t(53999);function c(e){let{...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"select",...s})}function d(e){let{...s}=e;return(0,a.jsx)(r.WT,{"data-slot":"select-value",...s})}function u(e){let{className:s,size:t="default",children:n,...l}=e;return(0,a.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":t,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...l,children:[n,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(i.A,{className:"size-4 opacity-50"})})]})}function h(e){let{className:s,children:t,position:i="popper",...n}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...n,children:[(0,a.jsx)(p,{}),(0,a.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(m,{})]})})}function x(e){let{className:s,children:t,...i}=e;return(0,a.jsxs)(r.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...i,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(n.A,{className:"size-4"})})}),(0,a.jsx)(r.p4,{children:t})]})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(l.A,{className:"size-4"})})}function m(e){let{className:s,...t}=e;return(0,a.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(i.A,{className:"size-4"})})}}},e=>{e.O(0,[1210,2048,9641,5702,5100,5452,6671,3207,3464,371,5299,9733,7535,193,5601,4419,8441,5964,7358],()=>e(e.s=53571)),_N_E=e.O()}]);